local jj = [[
  {"keyword":"Feature","name":"Create page definition","tags":[],"location":"features/CMS_3398.feature:1","status":"failed","elements":[{"type":"background","keyword":"Background","name":"Set token up","location":"features/CMS_3398.feature:2","steps":[{"keyword":"Given","step_type":"given","name":"I have a valid token","location":"features/CMS_3398.feature:3"},{"keyword":"And","step_type":"given","name":"I set the header field <X-Current-Site> to","location":"features/CMS_3398.feature:4","text":"4gmC_2"}]},{"type":"scenario","keyword":"Scenario","name":"Create a page definition","tags":[],"location":"features/CMS_3398.feature:10","steps":[{"keyword":"Given","step_type":"given","name":"I have a valid token","location":"features/CMS_3398.feature:3","match":{"location":"features/steps/athena.py:17","arguments":[]},"result":{"status":"passed","duration":0.00006818771362304688}},{"keyword":"And","step_type":"given","name":"I set the header field <X-Current-Site> to","location":"features/CMS_3398.feature:4","text":"4gmC_2","match":{"location":"features/steps/athena.py:36","arguments":[{"value":"<X-Current-Site>","name":"field"}]},"result":{"status":"passed","duration":0.00004506111145019531}},{"keyword":"Given","step_type":"given","name":"I set the query as","location":"features/CMS_3398.feature:11","text":["mutation CreatePageDefinition($input: CreatePageDefinitionInput!) {","    createPageDefinition(input: $input) {","        pageDefinition {","            id","            path","            title","            modified","            isPublished","            seoTitle","            seoDescription","            canonicalLink","        }","        userErrors {","            message","            field","        }","    }","}"],"match":{"location":"features/steps/athena.py:46","arguments":[]},"result":{"status":"passed","duration":0.0002818107604980469}},{"keyword":"And","step_type":"given","name":"I set the variables as","location":"features/CMS_3398.feature:32","text":["{","    \"input\":","    {","        \"path\":\"\\/a\\/s\\/d\",","        \"title\":\"Mary\",","        \"isPublished\":true,","        \"seoTitle\":null,","        \"seoDescription\":null,","        \"canonicalLink\":null","    }","}"],"match":{"location":"features/steps/athena.py:51","arguments":[]},"result":{"status":"passed","duration":0.00004982948303222656}},{"keyword":"When","step_type":"when","name":"I call Athena","location":"features/CMS_3398.feature:46","match":{"location":"features/steps/athena.py:56","arguments":[]},"result":{"status":"passed","duration":0.004792213439941406}},{"keyword":"Then","step_type":"then","name":"I expect the call to succeed","location":"features/CMS_3398.feature:47","match":{"location":"features/steps/athena.py:88","arguments":[]},"result":{"status":"failed","duration":0.0005161762237548828,"error_message":["Traceback (most recent call last):","  File \"/Users/tony/.pyenv/versions/bdd/lib/python3.12/site-packages/behave/model.py\", line 1329, in run","    match.run(runner.context)","  File \"/Users/tony/.pyenv/versions/bdd/lib/python3.12/site-packages/behave/matchers.py\", line 98, in run","    self.func(context, *args, **kwargs)","  File \"features/steps/athena.py\", line 90, in step_check_result_succeeds","    assert context.result","           ^^^^^^^^^^^^^^","  File \"/Users/tony/.pyenv/versions/bdd/lib/python3.12/site-packages/behave/runner.py\", line 321, in __getattr__","    raise AttributeError(msg)","AttributeError: 'Context' object has no attribute 'result'","","Captured logging:","INFO:gql.transport.aiohttp:>>> {\"query\": \"mutation CreatePageDefinition($input: CreatePageDefinitionInput!) {\\n  createPageDefinition(input: $input) {\\n    pageDefinition {\\n      id\\n      path\\n      title\\n      modified\\n      isPublished\\n      seoTitle\\n      seoDescription\\n      canonicalLink\\n    }\\n    userErrors {\\n      message\\n      field\\n    }\\n  }\\n}\", \"variables\": {\"input\": {\"path\": \"/a/s/d\", \"title\": \"Mary\", \"isPublished\": true, \"seoTitle\": null, \"seoDescription\": null, \"canonicalLink\": null}}}"]}}],"status":"failed"},{"type":"scenario","keyword":"Scenario","name":"Create a page definition with no title","tags":[],"location":"features/CMS_3398.feature:49","steps":[{"keyword":"Given","step_type":"given","name":"I have a valid token","location":"features/CMS_3398.feature:3","match":{"location":"features/steps/athena.py:17","arguments":[]},"result":{"status":"passed","duration":0.000036716461181640625}},{"keyword":"And","step_type":"given","name":"I set the header field <X-Current-Site> to","location":"features/CMS_3398.feature:4","text":"4gmC_2","match":{"location":"features/steps/athena.py:36","arguments":[{"value":"<X-Current-Site>","name":"field"}]},"result":{"status":"passed","duration":0.000036716461181640625}},{"keyword":"Given","step_type":"given","name":"I set the query as","location":"features/CMS_3398.feature:51","text":["mutation CreatePageDefinition($input: CreatePageDefinitionInput!) {","    createPageDefinition(input: $input) {","        pageDefinition {","            id","            path","            title","            modified","            isPublished","            seoTitle","            seoDescription","            canonicalLink","        }","        userErrors {","            message","            field","        }","    }","}"],"match":{"location":"features/steps/athena.py:46","arguments":[]},"result":{"status":"passed","duration":0.00023293495178222656}},{"keyword":"And","step_type":"given","name":"I set the variables as","location":"features/CMS_3398.feature:72","text":["{","    \"input\":","    {","        \"path\":\"\\/a\\/s\\/d\",","        \"isPublished\":true,","        \"seoTitle\":null,","        \"seoDescription\":null,","        \"canonicalLink\":null","    }","}"],"match":{"location":"features/steps/athena.py:51","arguments":[]},"result":{"status":"passed","duration":0.00004673004150390625}},{"keyword":"When","step_type":"when","name":"I call Athena","location":"features/CMS_3398.feature:85","match":{"location":"features/steps/athena.py:56","arguments":[]},"result":{"status":"passed","duration":0.0013990402221679688}},{"keyword":"Then","step_type":"then","name":"I expect the call to fail","location":"features/CMS_3398.feature:86","match":{"location":"features/steps/athena.py:93","arguments":[]},"result":{"status":"passed","duration":0.00003790855407714844}}],"status":"passed","description":["This scenario should fail as we need a title and path"]}]}
]]

local js = vim.json.decode(jj)

print(js.keyword .. "::" .. js.location .. "::" .. js.status .. "::" .. js.name)

for _, element in ipairs(js.elements) do
	if element.type == "scenario" then
		print(element.keyword .. "::" .. element.location .. "::" .. element.status .. "::" .. element.name)
	end
end

local query = [[
  (feature
    (name) @namespace.name
    (scenario
      (name) @test.name
    ) @test.description
  ) @namespace.description

]]

local file =
	"/Users/tony/Work/Contracts/Global/guacamole/services/athena/backend/donotgit/.bdd/features/CMS_3398.feature"

local pq = vim.treesitter.query.parse("gherkin", query)

print(vim.inspect(pq))
